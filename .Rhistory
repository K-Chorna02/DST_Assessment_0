# File is in the main repo folder
file_path <- "data/who_air_quality_2024.xlsx"
excel_sheets(file_path)
head(air_data)
if(!require("gplots")) install.packages("gplots")
if(!require("readr")) install.packages("readr")
library("gplots")
library("readr")
if(!dir.exists(file.path("..","data"))) dir.create(file.path("..","data"))
if(!file.exists(file.path("..","data","kddcup.data_10_percent.zip"))) download.file("http://kdd.org/cupfiles/KDDCupData/1999/kddcup.data_10_percent.zip", destfile=file.path("..","data","kddcup.data_10_percent.zip"))
if(!file.exists(file.path("..","data","kddcup.names"))) download.file("http://kdd.org/cupfiles/KDDCupData/1999/kddcup.names",destfile=file.path("..","data","kddcup.names"))
safedircreate<-function(...)
if(!dir.exists(file.path(...))) dir.create(file.path(...))
kddata<-as.data.frame(read_csv(file.path("..","data","kddcup.data_10_percent.zip"),col_names=FALSE)) ## Ignore the warnings - there is a bug with the header
kddnames=read.table(file.path("..","data","kddcup.names"),sep=":",skip=1,as.is=T)
colnames(kddata)=c(kddnames[,1],"normal") # here we fix the bug with the header
goodcat=names(which(table(kddata[,"normal"])>1))
kddata=kddata[kddata[,"normal"]%in%goodcat,]
head(kddata)
summary(kddata)
par(las=2) # Ask R to plot perpendicular to the axes
barplot((sort(table(kddata[,"normal"]))),log="y") # Log axis
labs=unique(as.character(kddata[,"normal"]))
names(labs)=labs
kddlist=lapply(labs,function(x){
kddata[kddata[,"normal"]==x,1:41]
})
kddmean=t(sapply(kddlist,function(x)colMeans(x[,c(1,5:41)])))
library("gplots")
heatmap.2(log(kddmean+1),margins =c(9,15),trace="none",cexCol = 0.5,main="Heatmap 1")
mycols=c("dst_bytes","src_bytes","duration","dst_host_svd_count","dst_host_count","srv_count","count")
head(sort(apply(log(kddmean+1),2,var),decreasing=TRUE),7)
kddfreq=apply(kddmean,2,function(x)x/(sum(x)+1)) ## Divide each column ()
kddfreq[!is.finite(kddfreq)]=0
kddfreq[is.nan(kddfreq)]=0
heatmap.2(kddfreq,margins =c(9,15),trace="none",cexCol = 0.5,main="Heatmap 2")
head(sort(apply(kddfreq,2,var),decreasing=TRUE),7)
mycategorical=colnames(kddata)[2:4]
classlist=lapply(mycategorical,function(mycat){
table(kddata[,c(mycat,"normal")])
})
for(i in 1:3) heatmap.2(log(classlist[[i]]+1),margins =c(9,15),trace="none",main=mycategorical[i])
kddsd=t(sapply(kddlist,function(x){
apply(x[,c(1,5:41)],2,sd)
}))
heatmap.2(log(kddsd/(kddmean+0.01)+1),margins =c(9,15),trace="none",main="Heatmap 3")
if(!require("gplots")) install.packages("gplots")
if(!require("readr")) install.packages("readr")
library("gplots")
library("readr")
